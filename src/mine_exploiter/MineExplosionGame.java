package mine_exploiter;

import java.util.Scanner;

//Al final tenemos la mayoría de funciones que necesita el proyecto recopiladas en una clase. 
//Empezamos por las funciones de la pantalla de inicio y el poner en marcha de la partida,
public class MineExplosionGame {
	
	// Representa al jugador.
    private Player player;   
    
    // Representa el tablero de juego.
    private Board board;      
    
    // Límite de tiempo para el juego.
    private int timeLimit;  
    
    
    //Constructor para incializar las variables
    
    public MineExplosionGame(String playerName, Board board, int timeLimit) {
    	
        // Inicializa al jugador con el nombre proporcionado.
        this.player = new Player(playerName);
        
        // Utiliza la instancia de Board proporcionada.
        this.board = board;
        
        // Establece el límite de tiempo para el juego.
        this.timeLimit = timeLimit;
    }

  //método que empieza el desarrollo del juego
    public void startGame() {
        System.out.println("El juego Explotaminas ha comenzado!!!");

     // Tiempo de inicio del juego
        long startTime = System.currentTimeMillis(); 
        
     // Verifica si el tiempo límite no se ha agotado
        
        while (System.currentTimeMillis() - startTime < timeLimit * 1000) { 
        	
        	// Muestra el estado actual del juego
            displayGameStatus(); 
            
             // Realiza el turno del jugador
            performPlayerTurn(); 
        }

        System.out.println("Se acabo el tiempo... Tu puntuacion final es: " + player.getScore());
    }
    
    // método para implementar la lógica para mostrar el estado actual del tablero, la puntuación, etc.


    private void displayGameStatus() {
    	
        System.out.println("Actual puntuacion: " + player.getScore());
        board.displayBoard();
    }

 // Lógica para que el jugador seleccione una casilla para descrubir las minas.
    private void performPlayerTurn() {
    	
        Scanner scanner = new Scanner(System.in);

        
        
        // Solicitar la entrada del jugador y luego procesar su elección.
        System.out.print("Ingresar fila (0-" + (board.getRows() - 1) + "): ");
        int row = scanner.nextInt();

        System.out.print("Ingresar columna (0-" + (board.getColumns() - 1) + "): ");
        int column = scanner.nextInt();

        // Lógica para verificar la casilla seleccionada y actualizar la puntuación.
        if (board.uncoverSquare(row, column)) {
        	player.increaseScore();
        	System.out.println("Boom - La mina exploto");
            System.out.println("Puntos ganados: 100");
            
        } else {
            System.out.println("Aqui no hay ninguna mina. Intenta otra vez");
        }
    }
}       